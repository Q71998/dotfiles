<snippet>
	<content><![CDATA[
#!/usr/bin/env python
# -*- coding: utf-8 -*-
import time
import requests
token = ""
def get_flag(host, port):
	${1:pass}

def submit_flag(flag):
	failed = '"error"'
	data = {
		"flag":flag,
		"token":token
	}
	print "[+] Submiting flag : [%s]" % (data)
	response = requests.post("http://192.168.1.110:3000/Flag/submit", data=data)
	content = response.content
	print "[+] Content : %s" % (content)
	if failed in content:
		print "[-] failed!"
		return False
	else:
		print "[+] Success!"
		return True

def exploit(host, port):
	print "[+] Exploiting : [%s:%s]" % (host, port)
	flag = get_flag(host, port)
	submit_flag(flag)

def exploit_all():
	port = 80
	hosts = []
	for host in range(1,27 + 1):
		hosts.append("192.168.1.%d" % (host))
	for host in hosts:
		exploit(host, port)

def main():
	while True:
		exploit_all()
		time.sleep(60)

if __name__ == "__main__":
	main()
]]></content>
	<tabTrigger>exploitall</tabTrigger>
	<scope>source.python</scope>
</snippet>
